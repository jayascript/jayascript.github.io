<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  SimPy: Simulating Real-World Processes With Python | Real Python | JayaScript
</title>
  <link rel="canonical" href="/publications/realpython-simpy-simulating-with-python.html">


  <link rel="stylesheet" href="/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="/theme/css/pygments/default.min.css">
  <link rel="stylesheet" href="/theme/css/theme.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Raleway:wght@200&display=swap">

  
  <meta name="description" content="In this step-by-step tutorial, you'll see how you can use the SimPy package to model real-world processes with a high potential for congestion. You'll create an algorithm to approximate a complex system, and then you'll design and run a simulation of that system in Python.">


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">

    <div class="col-sm-1 siteimagediv">
      <p align="center">
        <a href="/">
          <img class="img-fluid rounded" id="siteimage" src=/images/data.png alt="JayaScript">
        </a><img src="" alt="" width="100%" height="" style="">
      </p>
    </div>

  <div class="col-sm-8 titlediv">
    <h1 class="title"><a href="/">JayaScript</a></h1>
    <p class="text-muted" id="sitesubtitle">Linux · Python · Developer · Analytics</p>
  </div>

    <div class="col-sm-4 link_box">
      <ul class="list-inline">
        <li class="list-inline-item"><a href="/index.html"><i class="fa fa-home"></i></a></li>
        <li class="list-inline-item"><a href="/categories.html"><i class="fa fa-code"></i></a></li>
        <li class="list-inline-item"><a href="/pages/about.html"><i class="fa fa-user-circle"></i></a></li>
        <li class="list-inline-item"><a href="/pages/contact.html"><i class="fa fa-envelope"></i></a></li>
          <li class="list-inline-item"><a class="fab fa-github" href="https://github.com/jayascript/" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-twitter" href="https://twitter.com/jayascript" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fab fa-linkedin" href="https://www.linkedin.com/in/jayazhane/" target="_blank"></a></li>
          <li class="list-inline-item"><a class="fa fa-book" href="https://realpython.com/team/jayazhane/" target="_blank"></a></li>
        <!--           <li class="list-inline-item"><a href="/" target="_blank">Home</a></li>
          <li class="list-inline-item"><a href="/categories.html" target="_blank">Categories</a></li>

              <li class="list-inline-item text-muted">|</li>
            <li class="list-inline-item"><a href="/pages/about.html">About</a></li>
            <li class="list-inline-item"><a href="/pages/contact.html">Contact</a></li>
         -->
      </ul>

  </div>

</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  SimPy: Simulating Real-World Processes With Python | Real Python
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted">
          <i class="fas fa-calendar" aria-hidden="true"></i>
          2020-03-25
        </li>
        <li class="list-inline-item text-muted">
          <i class="fas fa-folder-open" aria-hidden="true"></i>
          <a href="/category/publications.html">Publications</a>
        </li>
          <li class="list-inline-item text-muted">
            <i class="fas fa-tag"></i>
              <a href="/tag/python.html">#python</a>,               <a href="/tag/simpy.html">#simpy</a>          </li>
      </ul>
    </header>
    <p align="center">
        <picture>
          <img id="cover" width="100%" src="/images/posts/publications/realpython-simpy-simulating-with-python.jpg" alt="SimPy: Simulating Real-World Processes With Python | Real Python">
        </picture>
    </p>
    <div class="content">
      <p>The real world is full of systems, like airports and highways, that frequently experience congestion and delay. When these systems are not optimized, their inefficiency can lead to countless unhappy customers and hours of wasted time. In this tutorial, you’ll learn how to use Python’s simpy framework to create virtual simulations that will help you solve problems like these.</p>
<p>In this tutorial, you’ll learn how to:</p>
<ul>
<li><strong>Use</strong> a simulation to model a real-world process</li>
<li><strong>Create</strong> a step-by-step algorithm to approximate a complex system</li>
<li><strong>Design</strong> and run a real-world simulation in Python with simpy</li>
</ul>
<p>In this tutorial, you’ll create a simulation for a local movie theater. Your goal is to provide the manager with a script to help find the optimal number of employees to have on staff.</p>
<p><strong>Read it on <a href="https://realpython.com/simpy-simulating-with-python/">Real Python</a></strong></p>
<p>Here's the source code for this script:</p>
<div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Companion code to https://realpython.com/simulation-with-simpy/</span>
<span class="sd">&#39;Simulating Real-World Processes With SimPy&#39;</span>
<span class="sd">Python version: 3.7.3</span>
<span class="sd">SimPy version: 3.0.11</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">simpy</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">statistics</span>

<span class="n">wait_times</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">class</span> <span class="nc">Theater</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">num_cashiers</span><span class="p">,</span> <span class="n">num_servers</span><span class="p">,</span> <span class="n">num_ushers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cashier</span> <span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">num_cashiers</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">num_servers</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">usher</span> <span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">num_ushers</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">purchase_ticket</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moviegoer</span><span class="p">):</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">check_ticket</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moviegoer</span><span class="p">):</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sell_food</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moviegoer</span><span class="p">):</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">go_to_movies</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">moviegoer</span><span class="p">,</span> <span class="n">theater</span><span class="p">):</span>
    <span class="c1"># Moviegoer arrives at the theater</span>
    <span class="n">arrival_time</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">now</span>

    <span class="k">with</span> <span class="n">theater</span><span class="o">.</span><span class="n">cashier</span><span class="o">.</span><span class="n">request</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">request</span>
        <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">theater</span><span class="o">.</span><span class="n">purchase_ticket</span><span class="p">(</span><span class="n">moviegoer</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">theater</span><span class="o">.</span><span class="n">usher</span><span class="o">.</span><span class="n">request</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">request</span>
        <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">theater</span><span class="o">.</span><span class="n">check_ticket</span><span class="p">(</span><span class="n">moviegoer</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]):</span>
        <span class="k">with</span> <span class="n">theater</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">request</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">request</span>
            <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">theater</span><span class="o">.</span><span class="n">sell_food</span><span class="p">(</span><span class="n">moviegoer</span><span class="p">))</span>

    <span class="c1"># Moviegoer heads into the theater</span>
    <span class="n">wait_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">arrival_time</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">run_theater</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">num_cashiers</span><span class="p">,</span> <span class="n">num_servers</span><span class="p">,</span> <span class="n">num_ushers</span><span class="p">):</span>
    <span class="n">theater</span> <span class="o">=</span> <span class="n">Theater</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">num_cashiers</span><span class="p">,</span> <span class="n">num_servers</span><span class="p">,</span> <span class="n">num_ushers</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">moviegoer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">go_to_movies</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">moviegoer</span><span class="p">,</span> <span class="n">theater</span><span class="p">))</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="mf">0.20</span><span class="p">)</span>  <span class="c1"># Wait a bit before generating a new person</span>

        <span class="n">moviegoer</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">go_to_movies</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">moviegoer</span><span class="p">,</span> <span class="n">theater</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">get_average_wait_time</span><span class="p">(</span><span class="n">wait_times</span><span class="p">):</span>
    <span class="n">average_wait</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wait_times</span><span class="p">)</span>
    <span class="c1"># Pretty print the results</span>
    <span class="n">minutes</span><span class="p">,</span> <span class="n">frac_minutes</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">average_wait</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">seconds</span> <span class="o">=</span> <span class="n">frac_minutes</span> <span class="o">*</span> <span class="mi">60</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">minutes</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_user_input</span><span class="p">():</span>
    <span class="n">num_cashiers</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Input # of cashiers working: &quot;</span><span class="p">)</span>
    <span class="n">num_servers</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Input # of servers working: &quot;</span><span class="p">)</span>
    <span class="n">num_ushers</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Input # of ushers working: &quot;</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_cashiers</span><span class="p">,</span> <span class="n">num_servers</span><span class="p">,</span> <span class="n">num_ushers</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">params</span><span class="p">):</span>  <span class="c1"># Check input is valid</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">params</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span>
            <span class="s2">&quot;Could not parse input. Simulation will use default values:&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1 cashier, 1 server, 1 usher.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">params</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Setup</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">num_cashiers</span><span class="p">,</span> <span class="n">num_servers</span><span class="p">,</span> <span class="n">num_ushers</span> <span class="o">=</span> <span class="n">get_user_input</span><span class="p">()</span>

    <span class="c1"># Run the simulation</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Environment</span><span class="p">()</span>
    <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">run_theater</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">num_cashiers</span><span class="p">,</span> <span class="n">num_servers</span><span class="p">,</span> <span class="n">num_ushers</span><span class="p">))</span>
    <span class="n">env</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

    <span class="c1"># View the results</span>
    <span class="n">mins</span><span class="p">,</span> <span class="n">secs</span> <span class="o">=</span> <span class="n">get_average_wait_time</span><span class="p">(</span><span class="n">wait_times</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span>
        <span class="s2">&quot;Running simulation...&quot;</span><span class="p">,</span>
        <span class="n">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The average wait time is {mins} minutes and {secs} seconds.&quot;</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
    </div>
  </article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
    <li class="list-inline-item"><a href="/archives.html">Archives</a></li>
    <li class="list-inline-item"><a href="/categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="/tags.html">Tags</a></li>
      <li class="list-inline-item text-muted">|</li>
        <li class="list-inline-item"><a class="fab fa-github" href="https://github.com/jayascript/" target="_blank"></a></li>
        <li class="list-inline-item"><a class="fab fa-twitter" href="https://twitter.com/jayascript" target="_blank"></a></li>
        <li class="list-inline-item"><a class="fab fa-linkedin" href="https://www.linkedin.com/in/jayazhane/" target="_blank"></a></li>
        <li class="list-inline-item"><a class="fa fa-book" href="https://realpython.com/team/jayazhane/" target="_blank"></a></li>
  </ul>

  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a> © 2020 Jaya Z. Powell
  </p>
</div>    </div>
  </footer>

</body>

</html>